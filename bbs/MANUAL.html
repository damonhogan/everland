<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>MANUAL</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#everland-manual" id="toc-everland-manual">Everland —
Manual</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#screenshots" id="toc-screenshots">Screenshots</a></li>
<li><a href="#fully-working-features"
id="toc-fully-working-features">Fully Working Features</a></li>
<li><a href="#whats-new-in-this-release"
id="toc-whats-new-in-this-release">What’s New In This Release</a></li>
<li><a href="#this-update-new-features"
id="toc-this-update-new-features">This Update — New Features</a></li>
<li><a href="#latest-operational-updates"
id="toc-latest-operational-updates">Latest Operational Updates</a></li>
<li><a href="#coin-bartender-quest-player-walkthrough"
id="toc-coin-bartender-quest-player-walkthrough">Coin / Bartender Quest
(player walkthrough)</a></li>
<li><a href="#partially-working-needs-attention"
id="toc-partially-working-needs-attention">Partially Working / Needs
Attention</a></li>
<li><a href="#beginner-player-manual"
id="toc-beginner-player-manual">Beginner Player Manual</a></li>
<li><a href="#quickstart-windows" id="toc-quickstart-windows">Quickstart
(Windows)</a></li>
<li><a href="#hp-regeneration" id="toc-hp-regeneration">HP &amp;
Regeneration</a></li>
<li><a href="#upcoming-recommended-features"
id="toc-upcoming-recommended-features">Upcoming / Recommended
Features</a></li>
<li><a href="#build-environment-notes"
id="toc-build-environment-notes">Build &amp; Environment Notes</a></li>
<li><a href="#credits" id="toc-credits">Credits</a></li>
<li><a href="#contact-next-steps" id="toc-contact-next-steps">Contact /
Next Steps</a></li>
<li><a href="#appendix-commands-used-to-create-the-pdf"
id="toc-appendix-commands-used-to-create-the-pdf">Appendix: Commands
Used To Create The PDF</a></li>
<li><a href="#pdf-location" id="toc-pdf-location">PDF Location</a></li>
<li><a href="#appendix-b-running-the-automated-vice-playtest-script"
id="toc-appendix-b-running-the-automated-vice-playtest-script">Appendix
B: Running the Automated VICE Playtest Script</a></li>
<li><a href="#appendix-c-build-environment-scripts-pdf-automation"
id="toc-appendix-c-build-environment-scripts-pdf-automation">Appendix C:
Build environment &amp; scripts (PDF automation)</a></li>
<li><a href="#wkhtmltopdf-installation-windows"
id="toc-wkhtmltopdf-installation-windows">wkhtmltopdf installation
(Windows)</a></li>
<li><a href="#note-about-powershell-execution-policy"
id="toc-note-about-powershell-execution-policy">Note about PowerShell
execution policy</a></li>
<li><a href="#what-we-did-locally-full-summary"
id="toc-what-we-did-locally-full-summary">What we did locally (full
summary)</a></li>
<li><a href="#appendix-d-artwork" id="toc-appendix-d-artwork">Appendix
D: Artwork</a></li>
<li><a href="#mermaid-trade-quest-player-walkthrough"
id="toc-mermaid-trade-quest-player-walkthrough">Mermaid Trade Quest
(player walkthrough)</a></li>
<li><a href="#current-development-todos"
id="toc-current-development-todos">Current Development Todos</a></li>
</ul></li>
</ul>
</nav>
<h1 id="everland-manual">Everland — Manual</h1>
<h2 id="overview">Overview</h2>
<p>Everland is a single-file Commodore 64 text-adventure written in Kick
Assembler. Build with KickAssembler and run in the VICE C64 emulator on
Windows.</p>
<h2 id="screenshots">Screenshots</h2>
<p>The following screenshots are included from the <code>images/</code>
folder.</p>
<p><img src="../images/screenshot1.png" alt="Screenshot 1" /> <img
src="../images/screenshot2.png" alt="Screenshot 2" /></p>
<h2 id="fully-working-features">Fully Working Features</h2>
<ul>
<li>Save/Load (EV4): Per-username profile saved to device 8. EV4 stores
username, display, class, race, pin, score, level, current HP,
class/race indices, max HP (for reference), calendar, location, object
locations, quest state, and coin balances (gold, silver, copper).
Backward-compatible loader accepts EV1/EV2/EV3.</li>
<li>Login/Profile: Username, display name, class, and race are selected
at first login. New users start with 1 silver and 9 copper and are
assigned 5 random starting trinkets.</li>
<li>Class &amp; Level System: Class base HP and HP-per-level; new
profiles start at Level 1.</li>
<li>HP System: Character sheet shows current and max HP; max HP is based
on class, level, and session bonuses. Current HP is saved; max HP is
recomputed and also persisted in EV3.</li>
<li>Coin System: Inventory displays gold, silver, and copper balances.
Many quest rewards pay out 1 silver; new users begin with 1 silver and 9
copper to ensure they can participate in early quests. Balances are
saved in the user record.</li>
<li>Idle Regeneration: While idle at prompts (i.e., not in a fight), HP
regenerates at 1 HP per real-time minute (uses KERNAL jiffy clock;
handles midnight wrap).</li>
<li>Inventory: Full-screen Inventory with <code>I</code>; shows coin
balances, carried items, and trinkets, and returns to the game when you
press Enter.</li>
<li>Characters &amp; Sheets: <code>C</code> opens character menu; view
player or NPC sheets with stats and HP.</li>
<li>Talk/NPC Selection: <code>T</code> opens talk screen; select any
present NPC.</li>
<li>Direct TALK: <code>TALK &lt;NPCNAME&gt;</code> jumps straight to
that NPC if present.</li>
<li>Conversation Menu: Options like speak/ask/comment/quests/end; many
branches apply effects (heals, score, quests).</li>
<li>Movement: Cardinal (<code>N/S/E/W</code>) and diagonal
(<code>NE/NW/SE/SW</code>) movement, with full words supported. Cardinal
directions work even if not directly shown in exits, using reverse
connections.</li>
<li>Rendering &amp; I/O: PETSCII message-buffer rendering; KERNAL file
and console I/O; music IRQ scaffolding.</li>
<li>Trinket Collection: Players collect up to 5 random trinkets at
creation; NPCs have up to 3 trinkets each. Trinkets are unique items for
social trading.</li>
<li>NPC Trinket Trading: Trade trinkets with NPCs via conversation
menus; select and swap trinkets to build relationships.</li>
<li>Banking Vault: Secure storage for items (10 slots, rent for 10
silver); items saved and retrievable.</li>
<li>Dynamic Exchange Rates: Bank rates fluctuate based on supply;
deposit/withdraw gold, silver, copper with current rates.</li>
</ul>
<p>Recent Additions (confirmed working) - Direct TALK:
<code>TALK &lt;NPCNAME&gt;</code> parsing and dispatch. - Diagonal
movement: <code>NE/NW/SE/SW</code> (and full words) plus exits display
updates. - New NPC content: - Saint Apollonia (Inn): Multi-step stories;
offering quest that heals to max and grants +score; leaving without
offering may penalize score. - Dragon Trainer Alyster (Dragon Haven):
Basics, care, practice; Advanced training grants a session-only +2 Max
HP bonus, heals to the new max, and +2 score. - Pirate Swordplay
(Clockwork Alley): Stance/footwork guidance; practice parry/lunge grants
+1 HP (capped) and +1 score. - Knight Arena Training (Gate): Guard
stance/footwork; practice parry/lunge grants +1 HP (capped) and +1
score. - Mermaid (Clockwork Alley): Trade a land-based item (pinecone)
for a sea-based item (sparkly shell); starts a themed trade quest and
grants the shell upon completion. - Character Sheet: Displays “HP:
current / max” and shows “+N MAX HP (SESSION)” when a temporary bonus is
active. - Save Format EV3: Saves current HP and the computed max HP;
compatible with older EV1/EV2 saves. - Idle HP regen: 1 HP per minute at
prompts; persists when HP changes. - Manual build helpers: PDF via
pandoc/TeX or pandoc+wkhtmltopdf; Dockerfile available.</p>
<h2 id="whats-new-in-this-release">What’s New In This Release</h2>
<ul>
<li>TALK improvements: Case-insensitive parsing and direct
<code>TALK &lt;NPCNAME&gt;</code>.</li>
<li>Character sheet HP line: Labeled “HP: current / max”; session HP
bonus note.</li>
<li>HP regeneration: 1 HP/min while idle, auto-saves on change.</li>
<li>EV3 saves: Persist current HP and max HP; EV1/EV2 remain
readable.</li>
<li>New/updated NPC content: Saint Apollonia, Alyster, Pirate
Captain/First Mate, Knight (training).</li>
<li>New/updated NPC content: Saint Apollonia, Alyster, Pirate
Captain/First Mate, Knight (training), Mermaid (trade quest).</li>
<li>Diagonal movement and exits display.</li>
</ul>
<h2 id="this-update-new-features">This Update — New Features</h2>
<ul>
<li><p>NPC cap increased to 32: the NPC tables and presence masks were
expanded so more characters can be present at once.</p></li>
<li><p>New NPCs and quests:</p>
<ul>
<li>Knight Kendrick (Plaza): a jovial, Scottish knight who keeps a
bottle of scotch. Kendrick offers a fetch quest — bring him a bottle of
scotch (from the Tiptsey Maiden tavern) to complete the quest and
receive a small reward.</li>
<li>Warlock (Plaza): gives the player a protective ward and requests it
be placed at the Portal fracture (the location formerly called the Gate;
the game now uses “Portal”).</li>
<li>Candy Witch (Alley): an opposing quest to the Warlock — she can
disable a ward; returning a disabled ward to the Warlock is a separate
flow and ties into a shared backstory.</li>
<li>Kora (Plaza): offers a playful jape quest — she asks the player to
SAY a phrase to Knight Kendrick. Use the new <code>SAY</code> command to
deliver the phrase and complete the quest.</li>
<li>Alyster oath (Order of the Emerald Sky): Alyster now offers an oath
quest with an explicit Y/N acceptance flow; accepting sets a
guild-membership flag in your profile.</li>
</ul></li>
<li><p>New command: <code>SAY &lt;phrase&gt; TO &lt;NPC&gt;</code> — a
text-say parser was added to validate phrases for specific NPC quests
(example: the Kora jape requires the phrase “SCOTCH ON THE KNIGHT” said
to Kendrick).</p></li>
<li><p>Portal rename: all references to the old “Gate” location were
renamed to “Portal” in the game and manual.</p></li>
<li><p>EVLOG quest logging: quest completions are recorded to an
<code>EVLOG</code> file (device 8 / PRG directory when virtual device
traps are enabled). Use the helper scripts in <code>tools/</code> to
extract/view <code>EVLOG</code> from the D64 or PRG directory.</p></li>
<li><p>Input improvements: username and other prompts now accept
multi-character input until Enter and echo typed characters (previous
single-char prompt behavior fixed).</p></li>
<li><p>UI fixes: the Characters/Talk lists no longer show a stray
“(UNKNOWN)” entry and the Conductor menu option text was
restored.</p></li>
<li><p>NPC Hitpoints &amp; Levels: NPCs now have level and current/max
HP like players. NPC level is used with the same class base/level HP
formula to compute an NPC’s max HP; current HP is stored in saves (EV3).
NPCs heal passively at the same rate as players (1 HP per real minute
while idle) and their current HP is auto-saved when it changes. The
Characters/Talk lists now display each NPC as “LV <n> HP <cur>/<max>”
where applicable.</p></li>
<li><p>Trinket System: Players and NPCs can collect up to 32 unique
trinkets. Players start with 5 random trinkets assigned at character
creation. NPCs have up to 3 trinkets each, randomly assigned when first
encountered. Trinkets are displayed in the inventory screen. Players can
trade trinkets with NPCs using the “TRADE TRINKETS” option in
conversations, selecting one trinket from their inventory and one from
the NPC’s collection to swap.</p></li>
<li><p>Advanced Banking: The Banker NPC now offers expanded services
including secure item vault storage (rent for 10 silver, 10 slots),
dynamic exchange rates that fluctuate based on bank supply, and full
deposit/withdraw menus for gold, silver, and copper. Vault items are
saved and can be retrieved later. Exchange rates adjust automatically to
simulate economic activity.</p></li>
</ul>
<h2 id="latest-operational-updates">Latest Operational Updates</h2>
<ul>
<li>Build helper: <code>tools/build_prg_simple.bat</code> compiles
<code>everland.asm</code> with your KickAssembler JAR, then refreshes a
D64 via <code>tools/make_d64.bat</code>.</li>
<li>Disk runner: <code>tools/run_from_d64.bat</code> mounts
<code>bin/everland.d64</code> on drive 8 and performs a simple
<code>load"*",8,1</code> then <code>run</code>.</li>
<li>TALK flow: Case-insensitive; <code>TALK &lt;NPCNAME&gt;</code> opens
that NPC if present. Menu indices start at 0 on the list.</li>
<li>HELP: Type <code>HELP</code> (or <code>?</code>) anytime to show
controls.</li>
<li>Conductor quest: Train Station option “3. Any quests?” starts the
coin quest and grants a coin.</li>
<li>Apollonia: “Leave an offering” — heals to max and grants +score;
leaving without offering may reduce score.</li>
<li>Alyster: “Advanced training” (after basics) — session-only +2 Max
HP, full heal, +2 score.</li>
<li>Diagonals: <code>NE/NW/SE/SW</code> movement and exits display.</li>
<li>Pirate/Knight practice: Each practice grants +1 HP (capped) and +1
score.</li>
</ul>
<h2 id="coin-bartender-quest-player-walkthrough">Coin / Bartender Quest
(player walkthrough)</h2>
<p>This release includes a small quest where the Conductor gives you a
special coin and asks you to tip the Bartender.</p>
<ol type="1">
<li>Accept the quest from the Conductor
<ul>
<li><code>TALK CONDUCTOR</code> then select the “Any quests?” menu
option (<code>3</code>) at the Train Station to accept
<code>QUEST_COIN_BARTENDER</code>. When accepted, you will also receive
a coin (an inventory object) and see a confirmation message that you
received it.</li>
</ul></li>
<li>Check your starting money
<ul>
<li>New users now start with 1 silver and 9 copper in addition to the
special quest coin from the Conductor. You can verify this with
<code>I</code> (Inventory), which shows GOLD / SILVER / COPPER at the
top of the screen.</li>
</ul></li>
<li>Tip the Bartender with the quest coin
<ul>
<li>Go to the Tavern and either:
<ul>
<li>Use a direct command like <code>GIVE COIN TO BARTENDER</code>,
or</li>
<li><code>TALK BARTENDER</code> and choose the tip option when it is
offered.</li>
</ul></li>
<li>If you are carrying the quest coin, the Bartender will take the
coin, add +1 silver to your balance, and, if
<code>QUEST_COIN_BARTENDER</code> is active, mark the quest
complete.</li>
</ul></li>
<li>Verify
<ul>
<li><code>I</code> should show that your silver increased by 1, and the
last messages will indicate that your tip was accepted and the quest is
complete.</li>
</ul></li>
</ol>
<p>Developer pointers (where to look in the source) - Coin system:
<code>playerGold</code>, <code>playerSilver</code>,
<code>playerCopper</code> store balances; <code>cmdInventory</code>
displays them; saved in EV4 format. - <code>cmdTake</code> and
<code>cmdGive</code> implement TAKE/GIVE parsing and behavior. -
<code>questCheckGive</code> looks up (object,npc) pairs for active
quests and calls <code>questComplete</code> when matched. - NPC HP/level
and regen: - <code>npcLevel</code>, <code>npcCurHp</code>, and
<code>npcClassIdx</code> tables define NPC level, current HP and class.
- <code>computeNpcMaxHp</code> computes NPC max HP from class &amp;
level (same formula as players). - <code>applyRegenIfDue</code> now
heals NPCs the same way as players; look for the NPC-healing loop.</p>
<h2 id="partially-working-needs-attention">Partially Working / Needs
Attention</h2>
<ul>
<li>Assembler Branch/Label Issues: Trampolines added where needed;
recommend a full assemble and focused review for remaining long-branch
patterns.</li>
<li>Conversation tree expansion: Per-npc/quest tables are in place but
branching trees and larger dialogue flows need more content and
testing.</li>
<li>SID Music: IRQ handler and new Celtic patterns added; full
soundtrack integration and voice balancing still in progress.</li>
<li>Quest edge-cases: Multi-stage quests persist, but complex state
transitions need playtesting.</li>
<li>UI polish: PETSCII art, pacing and transitions need refinement for
better immersion.</li>
<li>Automated emulator tests: Playtest scripts exist but comprehensive
deterministic harness (screenshots, long flows) is TODO.</li>
</ul>
<h2 id="beginner-player-manual">Beginner Player Manual</h2>
<p>Startup / Compile / Run</p>
<ul>
<li>Assemble with KickAssembler on Windows (example):</li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>java <span class="op">-</span>cp C<span class="op">:</span>\commodore\KickAssembler\KickAss<span class="op">.</span><span class="fu">jar</span> kickass<span class="op">.</span><span class="fu">KickAssembler</span> <span class="op">-</span>odir bin <span class="op">-</span>log c<span class="op">:</span>\commodore\everland\bin\buildlog<span class="op">.</span><span class="fu">txt</span> <span class="op">-</span>showmem <span class="op">-</span>vicesymbols c<span class="op">:</span>\commodore\everland\everland<span class="op">.</span><span class="fu">asm</span></span></code></pre></div>
<ul>
<li>Run in VICE: open <code>bin\everland.prg</code> or drag into
x64.</li>
</ul>
<h2 id="quickstart-windows">Quickstart (Windows)</h2>
<ul>
<li>Build + refresh disk image:</li>
</ul>
<div class="sourceCode" id="cb2"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>C<span class="op">:</span>\commodore\everland\tools\build_prg_simple<span class="op">.</span><span class="fu">bat</span> <span class="st">&quot;C:\commodore\KickAssembler\KickAss.jar&quot;</span></span></code></pre></div>
<ul>
<li>Run from D64 with auto LOAD/RUN (lowercase, wildcard):</li>
</ul>
<div class="sourceCode" id="cb3"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>C<span class="op">:</span>\commodore\everland\tools\run_from_d64<span class="op">.</span><span class="fu">bat</span> <span class="st">&quot;C:\commodore\GTK3VICE-3.10-win64\bin\x64sc.exe&quot;</span> <span class="st">&quot;C:\commodore\everland\bin\everland.d64&quot;</span></span></code></pre></div>
<p>First Run / Profiles</p>
<ul>
<li>On first run you’ll be prompted for a username/display and to pick a
player class. The chosen class affects HP and is saved.</li>
<li>Input &amp; PIN limitation (important): the current input handler
does <strong>not</strong> accept two identical characters in a row on
any line. This affects usernames, display names, free-text prompts and
PIN entry.
<ul>
<li>For PINs, choose a pattern that does not rely on repeated digits
like <code>1111</code> or <code>2222</code> (for example, use
<code>1212</code>, <code>1357</code>, etc.).</li>
<li>For names and phrases, avoid double letters like <code>ANNA</code>
or <code>AARON</code>; instead, choose variants without consecutive
identical characters (e.g., <code>ANA</code>, <code>ARON</code>) or
slightly rephrase.</li>
<li>Spaces are treated as regular characters; you can still have
multi-word inputs (e.g., <code>MAGE DAMON</code>), but you cannot type
two spaces back-to-back.</li>
</ul></li>
</ul>
<p>Core Controls</p>
<ul>
<li>Movement: N, S, E, W and NE, NW, SE, SW. Full words
<code>NORTHEAST</code>, <code>NORTHWEST</code>, <code>SOUTHEAST</code>,
<code>SOUTHWEST</code> also work. Diagonal exits appear in the exits
line when reachable.</li>
<li><code>C</code>: Characters menu — view player or NPC sheets.</li>
<li><code>I</code>: Inventory (full screen).</li>
<li><code>T</code>: Talk — select NPC and start conversation.</li>
<li>Direct talk: <code>TALK &lt;NPCNAME&gt;</code> (e.g.,
<code>TALK CONDUCTOR</code>).</li>
<li>Help: <code>HELP</code> or <code>?</code>.</li>
<li><code>ATTACK</code> / <code>FIGHT</code>: Melee attack an NPC at
your current location. Use <code>ATTACK &lt;npc&gt;</code> or
<code>FIGHT &lt;npc&gt;</code> to target someone.</li>
<li>Conversation: Type menu number and press Enter; choose “End” to
exit.</li>
</ul>
<p>Gameplay Loop</p>
<ul>
<li>Explore, talk to NPCs
(<code>T</code>/<code>TALK &lt;NPC&gt;</code>), check
<code>C</code>haracter sheet and <code>I</code>nventory, accept quests,
gain score/levels. Progress and HP updates are auto-saved on key events.
HP passively regenerates while idle.</li>
</ul>
<h2 id="hp-regeneration">HP &amp; Regeneration</h2>
<ul>
<li><p>Max HP: Determined by your class and level, plus any session-only
bonus.</p>
<ul>
<li>Formula: MaxHP = BaseHP(class) + PerLevel(class) × Level +
SessionBonus.</li>
<li>New profiles start at Level 1, so initial MaxHP includes one
per-level step.</li>
</ul></li>
<li><p>Session bonus: Some training (e.g., Alyster’s Advanced Training)
grants a temporary +Max HP for the current session only. The character
sheet shows “+N MAX HP (SESSION)” beneath your HP line when
active.</p></li>
<li><p>Viewing HP: Press <code>C</code> to open the character sheet and
see “HP: current / max”.</p></li>
<li><p>Regeneration: While idle at prompts (not actively performing
actions), you recover 1 HP per real-time minute. Regeneration is capped
at Max HP and is saved automatically when HP changes.</p>
<ul>
<li>NPCs: Non-player characters now use the same regeneration rules.
NPCs have <code>LV</code> and <code>HP</code> values; they recover 1 HP
per real minute (capped at their computed max) and their current HP is
persisted in EV3 saves.</li>
</ul></li>
</ul>
<p>Saving &amp; Loading</p>
<ul>
<li>Per-username save file (device 8). On startup the game loads your
profile; it auto-saves on key changes (e.g., HP regen, quests,
training).</li>
<li>Save format: EV3. The loader remains compatible with EV1/EV2 saves
created by earlier builds; EV3 adds race indices and max HP
reference.</li>
</ul>
<p>Troubleshooting</p>
<ul>
<li>If KickAssembler reports branch/label errors, re-run and paste the
build log; I can patch <code>everland.asm</code> to fix
trampolines.</li>
<li>If VICE hangs, try restarting the emulator or ensure the IRQ safe
stub is enabled in code.</li>
<li>If LOAD reports <code>?FILE NOT FOUND</code> in BASIC, use wildcard
and lowercase:</li>
</ul>
<pre class="basic"><code>load&quot;*&quot;,8,1
run</code></pre>
<ul>
<li>If input seems to “ignore” a key when you try to type the same
character twice (for example <code>1111</code> as a PIN, or double
letters in a name), this is expected with the current debounce logic.
The game only accepts one instance of any character before a different
character is typed. Adjust your PIN and names so they do not contain
consecutive identical characters.</li>
</ul>
<h2 id="upcoming-recommended-features">Upcoming / Recommended
Features</h2>
<ul>
<li>Full SID soundtrack and sound effects.</li>
<li>Expanded quest system and quest log UI.</li>
<li>Turn-based combat, skills, and status effects.</li>
<li>Improved inventory with equip/unequip and item stacking.</li>
<li>Enhanced PETSCII map, mini-map, and animations.</li>
<li>Multiple save slots and in-game save manager.</li>
<li>Joystick/controller support.</li>
<li>Reorganize code to avoid long-branch patterns and improve assembler
stability.</li>
</ul>
<h2 id="build-environment-notes">Build &amp; Environment Notes</h2>
<ul>
<li>Assembler: Kick Assembler (v5.25 in logs).</li>
<li>Editor: Visual Studio Code.</li>
<li>Emulator: VICE C64 Emulator on Windows.</li>
<li>Source: <code>everland.asm</code> in the project root. Build output
in <code>bin/</code>.</li>
</ul>
<h2 id="credits">Credits</h2>
<ul>
<li>Producer: Damon Hogan</li>
<li>Inspired by: Perry Fraptic (RetroRecipies YouTube)</li>
<li>Hardware inspiration: Commodore 64 Ultimate, commodore.net</li>
<li>Tooling: Kick Assembler, Visual Studio Code, VICE</li>
</ul>
<h2 id="contact-next-steps">Contact / Next Steps</h2>
<ul>
<li>To include screenshots: upload them into <code>images/</code> then
re-run the PDF conversion instructions below.</li>
<li>If you’d like, I can patch remaining assembler errors — paste the
latest build log.</li>
</ul>
<h2 id="appendix-commands-used-to-create-the-pdf">Appendix: Commands
Used To Create The PDF</h2>
<p>The PDF for this manual was produced using <code>pandoc</code> to
convert Markdown to PDF. Below are the exact commands you can run
locally to reproduce the same searchable PDF.</p>
<ol type="1">
<li>Convert Markdown directly to PDF via LaTeX (recommended if you have
a TeX engine installed):</li>
</ol>
<div class="sourceCode" id="cb5"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pandoc MANUAL<span class="op">.</span><span class="fu">md</span> <span class="op">-</span>o MANUAL<span class="op">.</span><span class="fu">pdf</span> <span class="op">--</span>pdf-engine<span class="op">=</span>xelatex <span class="op">--</span>toc</span></code></pre></div>
<ol start="2" type="1">
<li>Alternative: Generate HTML then convert to PDF with
<code>wkhtmltopdf</code> (if you prefer HTML rendering):</li>
</ol>
<div class="sourceCode" id="cb6"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Markdown -&gt; HTML</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>pandoc MANUAL<span class="op">.</span><span class="fu">md</span> <span class="op">-</span>o MANUAL<span class="op">.</span><span class="fu">html</span> <span class="op">--</span>standalone <span class="op">--</span>toc</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert HTML -&gt; searchable PDF with wkhtmltopdf</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>wkhtmltopdf MANUAL<span class="op">.</span><span class="fu">html</span> MANUAL<span class="op">.</span><span class="fu">pdf</span></span></code></pre></div>
<ol start="3" type="1">
<li>If you need only HTML output (searchable in browsers):</li>
</ol>
<div class="sourceCode" id="cb7"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pandoc MANUAL<span class="op">.</span><span class="fu">md</span> <span class="op">-</span>o MANUAL<span class="op">.</span><span class="fu">html</span> <span class="op">--</span>standalone <span class="op">--</span>toc</span></code></pre></div>
<p>Notes: - <code>--toc</code> generates a table of contents. - If
images are large, consider resizing before embedding to reduce PDF
size.</p>
<h2 id="pdf-location">PDF Location</h2>
<p>If I successfully generate <code>MANUAL.pdf</code> in the repository
root, it will be placed at <code>c:/commodore/everland/MANUAL.pdf</code>
and offered for download here.</p>
<h2 id="appendix-b-running-the-automated-vice-playtest-script">Appendix
B: Running the Automated VICE Playtest Script</h2>
<p>This appendix describes how to run the provided playtest helpers
(<code>tools/vice_playtest.ps1</code> and
<code>tools/vice_playtest.bat</code>) to automatically launch VICE and
run a short smoke-test sequence against
<code>bin/everland.prg</code>.</p>
<ol type="1">
<li>Quick launcher (recommended)</li>
</ol>
<ul>
<li>Use the batch file if you just want to start the emulator with the
PRG. From a Command Prompt or PowerShell in the project root run:</li>
</ul>
<div class="sourceCode" id="cb8"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tools\vice_playtest<span class="op">.</span><span class="fu">bat</span> <span class="st">&quot;C:\Program Files (x86)\VICE\x64sc.exe&quot;</span> <span class="st">&quot;c:\commodore\everland\bin\everland.prg&quot;</span></span></code></pre></div>
<p>If VICE is installed in the default path the arguments are
optional:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tools\vice_playtest<span class="op">.</span><span class="fu">bat</span></span></code></pre></div>
<ol start="2" type="1">
<li>Full scripted playtest (PowerShell)</li>
</ol>
<ul>
<li>The PowerShell script <code>tools/vice_playtest.ps1</code> launches
x64sc, waits for the emulator window, brings it to the foreground and
sends a small keystroke sequence to exercise a conversation flow
(example: <code>TALK BARTENDER</code> → choose menu option
<code>3</code>). To run it once without changing policy:</li>
</ul>
<div class="sourceCode" id="cb10"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="op">.</span>\tools\vice_playtest<span class="op">.</span><span class="fu">ps1</span> <span class="op">-</span>VicePath <span class="st">&quot;C:\Program Files (x86)\VICE\x64sc.exe&quot;</span> <span class="op">-</span>PrgPath <span class="st">&quot;.\bin\everland.prg&quot;</span></span></code></pre></div>
<ul>
<li>If the script is blocked by Windows Defender / SmartScreen or
another AV, unblock it and re-run:</li>
</ul>
<div class="sourceCode" id="cb11"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Unblock-File</span> <span class="op">.</span>\tools\vice_playtest<span class="op">.</span><span class="fu">ps1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="op">.</span>\tools\vice_playtest<span class="op">.</span><span class="fu">ps1</span></span></code></pre></div>
<p>Security and AV notes</p>
<ul>
<li>The PowerShell script sends keystrokes to the emulator window — some
endpoint protection tools flag or block this behavior. If your AV blocks
the script, prefer the batch launcher or add an exclusion for
<code>tools\vice_playtest.ps1</code> in your AV settings.</li>
<li><code>-ExecutionPolicy Bypass</code> runs the script just for the
process and does not permanently change system policy.</li>
</ul>
<p>Script behavior and customization</p>
<ul>
<li>What the script does by default:
<ul>
<li>Launches x64sc with <code>-autostart &lt;prg&gt;</code> and
<code>-warp</code> (fast boot).</li>
<li>Waits for the main emulator window and brings it to front.</li>
<li>Sends the keystrokes: <code>TALK BARTENDER{ENTER}</code> then
<code>3{ENTER}</code> (selects the conversation menu’s quest
option).</li>
<li>Pauses and lets you inspect the emulator before exiting.</li>
</ul></li>
<li>You can modify the script to send other sequences (e.g.,
<code>TAKE COIN{ENTER}</code>,
<code>GIVE COIN TO BARTENDER{ENTER}</code>) or longer test flows.
Timings are configurable (delays in milliseconds between SendKeys).</li>
</ul>
<p>Automating screenshot capture (optional)</p>
<ul>
<li>The script does not capture screenshots by default. To capture
screens you can:
<ul>
<li>Use a command-line screenshot tool (e.g., <code>nircmd.exe</code> or
<code>magick</code> from ImageMagick) and call it after the SendKeys
sequence.</li>
<li>Or use VICE’s built-in screenshot feature (keyboard binding) and
send that key sequence from the script (timing-sensitive).</li>
</ul></li>
</ul>
<p>Troubleshooting</p>
<ul>
<li>If VICE fails to start: verify the <code>-VicePath</code> you
provided points at <code>x64sc.exe</code> (or
<code>x64.exe</code>/<code>x64sc.exe</code> depending on your
build).</li>
<li>If the PRG doesn’t autostart: ensure <code>bin\everland.prg</code>
exists and is the output from the latest assembly.</li>
<li>If SendKeys appear to be ignored: ensure the emulator window has
keyboard focus and increase the script’s delay values.</li>
</ul>
<p>Extending the playtest harness</p>
<ul>
<li>I can add additional scripted flows (save/load, give item flows,
combat sequence) and optional screenshot collection. Tell me which flows
you’d like automated and I will add them to
<code>tools/vice_playtest.ps1</code> as named scenarios.</li>
</ul>
<h2 id="appendix-c-build-environment-scripts-pdf-automation">Appendix C:
Build environment &amp; scripts (PDF automation)</h2>
<p>This appendix documents the environment and scripts used to build the
manual, and includes a text copy of the build wrapper for
reproducibility.</p>
<ol type="1">
<li>Dependencies (for PDF creation)</li>
</ol>
<ul>
<li><code>pandoc</code> — the primary tool to convert Markdown to
HTML/PDF. Install from https://pandoc.org/</li>
<li>A TeX engine (one of):
<ul>
<li><code>xelatex</code> (recommended) — part of TeX Live or MiKTeX;
provides good Unicode and font handling.</li>
<li><code>pdflatex</code> — alternative TeX engine (also part of TeX
Live / MiKTeX).</li>
</ul></li>
<li><code>wkhtmltopdf</code> (optional) — alternative path: convert
Markdown -&gt; HTML via <code>pandoc</code>, then HTML -&gt; PDF via
<code>wkhtmltopdf</code>.</li>
<li><code>wkhtmltopdf</code> (optional) — alternative path: convert
Markdown -&gt; HTML via <code>pandoc</code>, then HTML -&gt; PDF via
<code>wkhtmltopdf</code>.</li>
</ul>
<h2 id="wkhtmltopdf-installation-windows">wkhtmltopdf installation
(Windows)</h2>
<p>If you prefer converting via HTML -&gt; PDF, install
<code>wkhtmltopdf</code>. On Windows you can install it in several
ways:</p>
<ul>
<li>Using Chocolatey (recommended if you have Chocolatey
installed):</li>
</ul>
<div class="sourceCode" id="cb12"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>choco install wkhtmltopdf <span class="op">-</span>y</span></code></pre></div>
<ul>
<li>Using Scoop (if you use Scoop):</li>
</ul>
<div class="sourceCode" id="cb13"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iwr</span> <span class="op">-</span>useb get<span class="op">.</span><span class="fu">scoop</span><span class="op">.</span><span class="fu">sh</span> <span class="op">|</span> <span class="fu">iex</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>scoop install wkhtmltopdf</span></code></pre></div>
<ul>
<li>Manual download (no package manager):</li>
</ul>
<ol type="1">
<li>Download the Windows 64-bit <code>wkhtmltopdf</code> binary ZIP from
the official releases page:
https://github.com/wkhtmltopdf/wkhtmltopdf/releases</li>
<li>Extract <code>wkhtmltopdf.exe</code> from the ZIP and place it in a
folder such as <code>C:\Program Files\wkhtmltopdf</code>.</li>
<li>Add that folder to your user PATH (or system PATH) and restart your
shell.</li>
</ol>
<h2 id="note-about-powershell-execution-policy">Note about PowerShell
execution policy</h2>
<p>If <code>tools\build_manual.ps1</code> is blocked on your system, run
it with <code>-ExecutionPolicy Bypass</code> so the wrapper can run
without changing system policy permanently:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="op">.</span>\tools\build_manual<span class="op">.</span><span class="fu">ps1</span></span></code></pre></div>
<p>After installing <code>wkhtmltopdf</code> and ensuring it’s on your
PATH, re-run the wrapper above — it will detect <code>wkhtmltopdf</code>
and use it to convert the generated <code>MANUAL.html</code> to
<code>MANUAL.pdf</code>. - Docker (optional) — we provide a Dockerfile
below to build the manual inside a container without installing TeX
locally. See the <code>tools/Dockerfile</code> file. - Optional
screenshot / helper tools (only for extended playtests):
<code>nircmd.exe</code>, <code>ImageMagick (magick)</code>, or any
command-line screenshot tool.</p>
<h2 id="what-we-did-locally-full-summary">What we did locally (full
summary)</h2>
<p>This project attempted multiple routes to produce
<code>MANUAL.pdf</code> on a Windows dev machine; the following
documents exactly what we ran and what succeeded.</p>
<ul>
<li><p>Step: Run <code>tools/build_manual.ps1</code> initially. Result:
<code>pandoc</code> found, no TeX engines detected, no
<code>wkhtmltopdf</code> present — script produced
<code>MANUAL.html</code> fallback.</p></li>
<li><p>Step: Attempted to install <code>wkhtmltopdf</code> via
Chocolatey (non-elevated). Result: <code>choco</code> was not
found.</p></li>
<li><p>Step: Attempted Chocolatey bootstrap as an elevated process
(UAC). The installer was launched but the elevated session did not leave
a usable <code>choco</code> binary in the non-elevated shell (install
requires admin and interactive UAC acceptance). Because automated
elevation in this environment is unreliable, we fell back to a
user-level installer.</p></li>
<li><p>Step: Installed <code>wkhtmltopdf</code> via Scoop (user-level).
Commands used:</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Set-ExecutionPolicy</span> Bypass <span class="op">-</span>Scope <span class="cf">Process</span> <span class="op">-</span>Force</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">iwr</span> <span class="op">-</span>useb get<span class="op">.</span><span class="fu">scoop</span><span class="op">.</span><span class="fu">sh</span> <span class="op">|</span> <span class="fu">iex</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>scoop update</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>scoop bucket add extras</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>scoop install wkhtmltopdf</span></code></pre></div>
<ul>
<li><p>Step: Re-ran <code>tools/build_manual.ps1</code>.
<code>pandoc</code> and <code>wkhtmltopdf</code> were detected, but
<code>wkhtmltopdf</code> initially failed with
network/ProtocolUnknownError when converting because local images were
not accessible by default.</p></li>
<li><p>Fix: Regenerated HTML with <code>pandoc</code> then converted
with <code>wkhtmltopdf --enable-local-file-access</code> to allow
embedded <code>images/</code> files to load. Command used:</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pandoc MANUAL<span class="op">.</span><span class="fu">md</span> <span class="op">-</span>o MANUAL<span class="op">.</span><span class="fu">html</span> <span class="op">--</span>standalone <span class="op">--</span>toc</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>wkhtmltopdf <span class="op">--</span>enable-local-file-access MANUAL<span class="op">.</span><span class="fu">html</span> MANUAL<span class="op">.</span><span class="fu">pdf</span></span></code></pre></div>
<ul>
<li>Result: <code>MANUAL.pdf</code> was successfully created and placed
in the repository root.</li>
</ul>
<p>Files modified during this process: -
<code>tools/build_manual.ps1</code> — updated to pass
<code>--enable-local-file-access</code> to <code>wkhtmltopdf</code> to
avoid the ProtocolUnknown/blocked local file access error. -
<code>MANUAL.md</code> — Appendix C updated with these notes and
step-by-step install instructions for <code>wkhtmltopdf</code>. -
<code>MANUAL.pdf</code> — generated and added to the repo.</p>
<p>Notes and recommendations - When converting Markdown -&gt; HTML -&gt;
PDF with <code>wkhtmltopdf</code>, use
<code>--enable-local-file-access</code> so local images referenced with
relative paths load correctly. - If you prefer a system-wide package
manager, Chocolatey works but requires admin privileges and UAC
acceptance; Scoop provides a user-friendly, non-admin alternative on
Windows. - Docker provides a fully reproducible environment if you
cannot or do not wish to install TeX or <code>wkhtmltopdf</code>
locally.</p>
<ol start="2" type="1">
<li>Build wrapper (text copy) The repository includes
<code>tools/build_manual.ps1</code>, a PowerShell wrapper that detects
available engines and builds <code>MANUAL.pdf</code> if possible
(falling back to <code>MANUAL.html</code> otherwise). The full script is
below:</li>
</ol>
<p>—- begin <code>build_manual.ps1</code> —- <inserted-script></p>
<p>—- end <code>build_manual.ps1</code> —-</p>
<p>Replace <code>&lt;inserted-script&gt;</code> with the following exact
contents (copy-paste into a file):</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;#</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">Build wrapper for MANUAL.md -&gt; MANUAL.pdf</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">Detects available PDF engines (xelatex, pdflatex, wkhtmltopdf) and runs pandoc accordingly.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">Usage: powershell -ExecutionPolicy Bypass -File .\tools\build_manual.ps1</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">param</span><span class="op">(</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$ManualMd</span> <span class="op">=</span> <span class="st">&quot;MANUAL.md&quot;</span><span class="op">,</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$OutPdf</span> <span class="op">=</span> <span class="st">&quot;MANUAL.pdf&quot;</span><span class="op">,</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span><span class="dt">string</span><span class="op">]</span><span class="va">$OutHtml</span> <span class="op">=</span> <span class="st">&quot;MANUAL.html&quot;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Which<span class="op">(</span><span class="va">$name</span><span class="op">)</span> <span class="op">{</span> </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">$c</span> <span class="op">=</span> <span class="fu">Get-Command</span> <span class="va">$name</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$c</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="va">$c</span><span class="op">.</span><span class="fu">Source</span> <span class="op">}</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">$null</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="va">$pandoc</span> <span class="op">=</span> Which <span class="st">&quot;pandoc&quot;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(-not</span> <span class="va">$pandoc</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;pandoc not found in PATH. Please install pandoc.&quot;</span> <span class="op">-</span>ForegroundColor Red</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">exit</span> <span class="dv">2</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="va">$xelatex</span> <span class="op">=</span> Which <span class="st">&quot;xelatex&quot;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="va">$pdflatex</span> <span class="op">=</span> Which <span class="st">&quot;pdflatex&quot;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="va">$wkhtmltopdf</span> <span class="op">=</span> Which <span class="st">&quot;wkhtmltopdf&quot;</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;Found: pandoc=</span><span class="va">$pandoc</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$xelatex</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Found xelatex: </span><span class="va">$xelatex</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Cyan <span class="op">}</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$pdflatex</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Found pdflatex: </span><span class="va">$pdflatex</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Cyan <span class="op">}</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$wkhtmltopdf</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Found wkhtmltopdf: </span><span class="va">$wkhtmltopdf</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Cyan <span class="op">}</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$xelatex</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Building PDF via xelatex...&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="va">$pandoc</span> <span class="va">$ManualMd</span> <span class="op">-</span>o <span class="va">$OutPdf</span> <span class="op">--</span>pdf-engine<span class="op">=</span>xelatex <span class="op">--</span>toc</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$LASTEXITCODE</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Created </span><span class="va">$OutPdf</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Green<span class="op">;</span> <span class="cf">exit</span> <span class="dv">0</span> <span class="op">}</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;pandoc/xelatex failed (exit </span><span class="va">$LASTEXITCODE</span><span class="st">)&quot;</span> <span class="op">-</span>ForegroundColor Red<span class="op">;</span> <span class="cf">exit</span> <span class="va">$LASTEXITCODE</span> <span class="op">}</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$pdflatex</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Building PDF via pdflatex...&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="va">$pandoc</span> <span class="va">$ManualMd</span> <span class="op">-</span>o <span class="va">$OutPdf</span> <span class="op">--</span>pdf-engine<span class="op">=</span>pdflatex <span class="op">--</span>toc</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$LASTEXITCODE</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Created </span><span class="va">$OutPdf</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Green<span class="op">;</span> <span class="cf">exit</span> <span class="dv">0</span> <span class="op">}</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;pandoc/pdflatex failed (exit </span><span class="va">$LASTEXITCODE</span><span class="st">)&quot;</span> <span class="op">-</span>ForegroundColor Red<span class="op">;</span> <span class="cf">exit</span> <span class="va">$LASTEXITCODE</span> <span class="op">}</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$wkhtmltopdf</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Building HTML then converting via wkhtmltopdf...&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="va">$pandoc</span> <span class="va">$ManualMd</span> <span class="op">-</span>o <span class="va">$OutHtml</span> <span class="op">--</span>standalone <span class="op">--</span>toc</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$LASTEXITCODE</span> <span class="op">-ne</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;pandoc-&gt;HTML failed (exit </span><span class="va">$LASTEXITCODE</span><span class="st">)&quot;</span> <span class="op">-</span>ForegroundColor Red<span class="op">;</span> <span class="cf">exit</span> <span class="va">$LASTEXITCODE</span> <span class="op">}</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="va">$wkhtmltopdf</span> <span class="va">$OutHtml</span> <span class="va">$OutPdf</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="va">$LASTEXITCODE</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Created </span><span class="va">$OutPdf</span><span class="st"> via wkhtmltopdf&quot;</span> <span class="op">-</span>ForegroundColor Green<span class="op">;</span> <span class="cf">exit</span> <span class="dv">0</span> <span class="op">}</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;wkhtmltopdf failed (exit </span><span class="va">$LASTEXITCODE</span><span class="st">)&quot;</span> <span class="op">-</span>ForegroundColor Red<span class="op">;</span> <span class="cf">exit</span> <span class="va">$LASTEXITCODE</span> <span class="op">}</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Fallback: produce HTML and inform user</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;No PDF engine found (xelatex/pdflatex/wkhtmltopdf). Producing HTML fallback...&quot;</span> <span class="op">-</span>ForegroundColor Yellow</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="op">&amp;</span> <span class="va">$pandoc</span> <span class="va">$ManualMd</span> <span class="op">-</span>o <span class="va">$OutHtml</span> <span class="op">--</span>standalone <span class="op">--</span>toc</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="va">$LASTEXITCODE</span> <span class="op">-eq</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;Created </span><span class="va">$OutHtml</span><span class="st">. Install a TeX engine or wkhtmltopdf to produce PDF.&quot;</span> <span class="op">-</span>ForegroundColor Yellow<span class="op">;</span> <span class="cf">exit</span> <span class="dv">1</span> <span class="op">}</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="op">{</span> <span class="fu">Write-Host</span> <span class="st">&quot;pandoc-&gt;HTML failed (exit </span><span class="va">$LASTEXITCODE</span><span class="st">)&quot;</span> <span class="op">-</span>ForegroundColor Red<span class="op">;</span> <span class="cf">exit</span> <span class="va">$LASTEXITCODE</span> <span class="op">}</span></span></code></pre></div>
<ol start="3" type="1">
<li>Docker build (one-step reproducible PDF)</li>
</ol>
<p>Use the provided <code>tools/Dockerfile</code> to build the manual
inside a container that already includes pandoc + TeX. Example:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>docker build <span class="op">-</span>t everland-manual <span class="op">-</span>f tools<span class="op">/</span>Dockerfile <span class="op">.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>docker create <span class="op">--</span>name tmp everland-manual</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>docker <span class="fu">cp</span> tmp<span class="op">:/</span>work<span class="op">/</span>MANUAL<span class="op">.</span><span class="fu">pdf</span> <span class="op">.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>docker <span class="fu">rm</span> tmp</span></code></pre></div>
<p>The Dockerfile uses the <code>pandoc/latex</code> base image and runs
<code>pandoc MANUAL.md -o MANUAL.pdf --pdf-engine=xelatex --toc</code>
during build; the generated PDF will be present at
<code>/work/MANUAL.pdf</code> inside the image.</p>
<ol start="4" type="1">
<li>Rebuilding the manual using the wrapper</li>
</ol>
<p>To rebuild locally (non-Docker):</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="op">.</span>\tools\build_manual<span class="op">.</span><span class="fu">ps1</span></span></code></pre></div>
<p>If the script reports missing
<code>xelatex</code>/<code>pdflatex</code>/<code>wkhtmltopdf</code>,
either install one of those or use the Docker method above.</p>
<h2 id="appendix-d-artwork">Appendix D: Artwork</h2>
<p>This appendix catalogs curated artwork used in Everland. These are
included in the repository under <code>images/</code> and can be
embedded in the manual or used as cover art.</p>
<p>– Spider Princess (cover candidate)</p>
<figure>
<img src="../images/SpiderPrincess1Up.png" alt="Spider Princess" />
<figcaption aria-hidden="true">Spider Princess</figcaption>
</figure>
<p>– Mermaid at Medieval Theme Park (NPC quest ambiance)</p>
<figure>
<img
src="../images/mermaid_sitting_in_a_wicker_chair_at_a_medieval_theme_park_she_will_tend_to_quests_with_patrons_blo_arttzoc89ruq0s6vmraj_2.png"
alt="Mermaid Sitting in Wicker Chair" />
<figcaption aria-hidden="true">Mermaid Sitting in Wicker
Chair</figcaption>
</figure>
<p>– Bridge the Troll &amp; Kevin (Market NPC ambience)</p>
<figure>
<img src="../images/BridgeAndKevin1.png" alt="Bridge and Kevin" />
<figcaption aria-hidden="true">Bridge and Kevin</figcaption>
</figure>
<p>– Damian (portrait / cover variant)</p>
<figure>
<img src="../images/Damian1Up.png" alt="Damian 1Up" />
<figcaption aria-hidden="true">Damian 1Up</figcaption>
</figure>
<p>– Lezule the Fairy (Fairy Gardens ambiance)</p>
<figure>
<img
src="../images/fairy_named_lezule_lezule_colored_in_the_fairy_gardens_sweet_and_tender_shy_mouth_open_waiting_to_m_mthcye2lh1va3w5b8vtv_2.png"
alt="Lezule Fairy" />
<figcaption aria-hidden="true">Lezule Fairy</figcaption>
</figure>
<p>– Mage Damon (portrait / mage variant)</p>
<figure>
<img src="../images/MageDamon3Up.png" alt="Mage Damon 3Up" />
<figcaption aria-hidden="true">Mage Damon 3Up</figcaption>
</figure>
<h2 id="mermaid-trade-quest-player-walkthrough">Mermaid Trade Quest
(player walkthrough)</h2>
<p>This release adds a themed trade quest offered by the Mermaid in
Clockwork Alley. Exchange a land-based item (pinecone) for a sea-based
item (sparkly shell).</p>
<ol type="1">
<li>Accept the quest from the Mermaid
<ul>
<li><code>TALK MERMAID</code> at Clockwork Alley and choose the
conversation option to ask about a trade. This starts
<code>QUEST_MERMAID_TRADE</code> (shown in the quest list as “TRADE LAND
FOR SEA”).</li>
</ul></li>
<li>Get a pinecone (land coral)
<ul>
<li>Travel to the Grove and run:</li>
</ul></li>
</ol>
<pre><code>TAKE PINECONE</code></pre>
<pre><code>- Verify with `I` (Inventory) that `PINECONE` is now in your inventory. You can also run `INSPECT PINECONE` for flavor text.</code></pre>
<ol start="3" type="1">
<li>Offer the pinecone to the Mermaid
<ul>
<li>Return to Clockwork Alley and either:
<ul>
<li><code>GIVE PINECONE TO MERMAID</code>, or</li>
<li><code>TALK MERMAID</code> and choose the conversation option to
offer land coral.</li>
</ul></li>
<li>If <code>QUEST_MERMAID_TRADE</code> is active and you have the
pinecone, the Mermaid will take the pinecone, give you a sparkly shell,
and complete the quest.</li>
</ul></li>
<li>Verify
<ul>
<li><code>I</code> should show the pinecone removed and
<code>SHELL</code> added. You can <code>INSPECT SHELL</code> to view its
description.</li>
</ul></li>
</ol>
<p>Developer pointers (where to look in the source) - See <a
href="everland.asm">everland.asm</a> for: - Objects:
<code>OBJ_PINECONE</code> and <code>OBJ_SHELL</code> enumerations;
<code>objLoc</code> sets initial pinecone spawn in the Grove and the
shell is granted by the Mermaid. - Quest:
<code>QUEST_MERMAID_TRADE</code> enumeration and completion flow;
current reward handler uses the default completion path. - Conversation:
<code>mermaidConversation</code> and its dispatch via
<code>@conv_mermaid</code> in <code>convSpeakHandler</code>. - Parser:
<code>kwMermaid</code>, <code>kwPinecone</code>, <code>kwShell</code>
keywords mapped in <code>parseNpcNoun</code> and
<code>parseObjectNoun</code>. - Location/NPC mask:
<code>npcMaskByLocHi</code> updates include the Mermaid’s presence at
Clockwork Alley.</p>
<h2 id="current-development-todos">Current Development Todos</h2>
<ul>
<li>Playtest NPC HP/level feature: Run VICE emulator to verify NPC
character sheets display LV and HP, and regen heals NPCs at 1
HP/min.</li>
<li>Fix Warlock noun parsing: Update <code>parseNpcNoun</code> to handle
<code>kwWarlock</code> for the Warlock NPC.</li>
<li>Implement coin system: Add gold, silver, copper balances to
inventory, save in EV4, display in inventory, quest rewards 1 silver,
new users 9 copper. (Completed)</li>
<li>Fix exit travel: Ensure all cardinal and diagonal movement works by
allowing cardinal directions to use reverse connections if direct exits
are missing. (Completed)</li>
</ul>
</body>
</html>
